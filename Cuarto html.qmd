---
title: "Trabajo"
author: "Francisca Apablaza"
format: html
editor: visual
bibliography: Inequidades de genero en el mercado laboral.bib
link-citations: true
---

# Participación en el mercado laboral

## dos gatos

### tres gatos

#### cuatro gatos

## Introduccion

En el presente trabajo abordare la inequidad de género específicamente en el mercado laboral. Analizando que elementos podrían afectar en el desarrollo desigual entre hombres y mujeres dentro del mercado laboral. El principal tema que surge cuando hablamos de una desigualdad de género en el trabajo, es la brecha salarial. Sin embargo, quisiera adentrarme en las relaciones que existen dentro de esta esfera y que podrían afectar como cada persona experimenta el mercado laboral.

Existen diversos estudios sobre la inequidad de género y aun así los estudios sobre la mujer integrada en el sistema laboral siguen siendo uno de los más relevantes, [@defanelliPatronesDesigualdadSocial1989]. Quisiera detenerme en dos puntos para explicar la relevancia del tema. El primer punto es sobre la importancia de la esfera económica para la subsistencia del individuo, ya que parece algo obvio pero el salario que obtenemos de nuestro trabajo es lo que nos permite desarrollarnos en otros ámbitos, sin embargo y esto es parte de lo que analizare, este salario es diferente entre hombres y mujeres por el mismo trabajo realizado. Y esto es un problema, [ver @nietoDiscriminacionDiferencialesSalarios2016].

El segundo punto es sobre las formas de relación que existen en el mercado laboral y que implicancias trae para las mujeres, ¿optamos a los mismos puestos que los hombres?, ¿cuántas horas le dedicamos al trabajo?, ¿cuántas mujeres están integradas en el mercado laboral? [@delattesEmpleoFemeninoDesarrollo1977]. Y más preguntas que podemos realizarnos, para dilucidar como es la relación de las mujeres dentro del mercado laboral a diferencia de los hombres. En otras palabras, que valor tiene la mujer para el mercado laboral.

Pero antes qué es el mercado laboral, en este estudio me referiré a las ofertas laborales específicamente del trabajo asalariado, no con intención de invisibilizar las otras manifestaciones de trabajo, si no para poder acotar y contextualizar el problema de estudio que ya de por si cuenta con varias aristas. Entonces esta incorporación de la mujer al mundo laboral debió haber sido un momento revolucionario de autonomía para cada mujer, sin embargo, no todo puede ser color de rosas, y dejo en evidencia una problemática sistemática de una sociedad patriarcal, que existe un sesgo de género, en la retribución como en las interacciones en el mercado laboral, he aquí la relevancia de estudiar este tema, [ver @abramoInsercionLaboralMujeres2004].

Si nos ponemos a analizar el mercado laboral no tardamos en darnos cuenta que es un mercado desigual, y esto a simple vista no tiene porque ser un problema, ya que no todos podemos ofrecer la misma fuerza de trabajo, y no todo trabajo es retribuido de la misma forma, el conflicto en todo esto esta cuando empezamos a observar que gran parte de esta desigualdad viene por una desigualdad de clase, educación, y también género, [ver @consueloiranzoEspacioFemeninoMundo2009]. Es por esto que debemos analizar la inequidad de genero en el mercado laboral desde una perspectiva interseccional, tomando en cuenta algunos elementos que pueden afectar esta inequidad, factores como educación, si la persona esta casada o si tiene hijos.

Con todo lo mencionado la hipótesis centras de este trabajo es que existe un sesgo de género que afecta de manera negativa a las mujeres en el mercado laboral, desde su inserción, su desempeño a nivel social y su retribución económica. Me centrare en 3 ejes fundamentales que ya hemos estado haciendo un acercamiento.

El primero punto es sobre la brecha laboral de género, es decir si realmente hay mas hombres que mujeres en el mercado laboral, debido a que la mujer realiza mas trabajos informales que los hombres, como el trabajo doméstico no remunerado, deberíamos ver una diferencia en la participación de ambos actores en el trabajo asalariado, [ver @nietoDiscriminacionDiferencialesSalarios2016].

El segundo punto que analizare, es el rol que cumple la familia, es decir mujeres casadas y con hijos en comparación a hombres. En este punto me interesa abordarlo, debido a lo que mencione anteriormente, ya que la mujer se ve enfrentadas a otras tareas que puede diferenciarla al momento de integrarse al mercado laboral [ver @defanelliPatronesDesigualdadSocial1989].

Y por último, analizare la brecha salarial, si existe diferencia en los ingresos de hombres y mujeres, ver [@nietoDiscriminacionDiferencialesSalarios2016]. Por la naturaleza de la base de datos a analizar puede que se manifieste en el ingreso por hogar y la configuración de esos hogares es decir cuando la mujer es jefe de hogar a deferencia de cuando lo es un hombre o si hay algun otro elemento que influya en el salario.

Me interesa centrarme en estas 3 aristas para poder realizar un radiografía que me permita abarcar la mayor cantidad de aspectos sobre la inequidad de genero en el mercado laboral.

### Metodología

En el presente trabajo para lograr realizar un análisis estadístico de las “inequidades de genero en el mercado laboral” estaré trabajando con la base de dados de la Encuesta de Caracterización Socioeconómica Nacional, desde ahora (CASEN), la cual es una encuesta hacia los hogares realizado por el Ministerio de Desarrollo Social y Familia.

Trabajare con una serie de variables que me permitan abordar las 3 aristas que propuse anteriormente, ahora bien, como primer filtro estaré trabajando la base de datos entre los rangos etarios desde los 25 años hasta los 65 años, ya que es la principal población activa, en el mercado laboral, se que en la practica esto difiere, sin embargo, por efectos prácticos del análisis, y acotar el trabajo, lo realice así.

Por otro lado, el objetivo es ver como se comportan las variables en relación al género, si existe una diferencia significativa y analiza se hombres y mujeres se desarrollan distintos en el mercado laboral. Para esto cada variable será cruzada con la variable de sexo.

## Trabajo en Rstudio

A lo largo de esta investigación, he trabajado con cuatro scripts con el objetivo de mantener el orden y para llevar a cabo distintos análisis de las variables. A partir de aquí, presentaré el desarrollo realizado en cada uno de estos scripts, junto con sus resultados, análisis y conclusiones. Todo con el objetivo de realizar un análisis de la participación en el mercado laboral en Chile.

#### Cargar paquetes:

```{r}
pacman::p_load(sjlabelled, dplyr, stargazer, sjmisc, summarytools, kableExtra, sjPlot, corrplot, sessioninfo, ggplot2)
```

#### Cargar base de datos:

```{r}
load(url("https://github.com/panchamama/Practico-1/raw/main/1.%20input/casen_rec.rdata"))
```

Recodificamos la base de datos por edad entre 15 hasta 65 años

```{r}
casen_rec <- casen_rec %>% dplyr:: filter(edad >= 18 & edad <= 65)
```

```{r}
dim(casen_rec)
names(casen_rec)
```

Vemos los primeros descriptivos que nos ofrece la base datos

```{r}
sjmisc::descr(casen_rec,
      show = c("label","range", "mean", "sd", "NA.prc", "n"))%>%
      kable(.,"markdown")
```

### Analisis de variables

Lo primero que realizo es una asociacion entre algunas variable y cruzadas con la variable de sexo esto para tener una primera visualizacion de la participacion laboral

a\) Realizo trabajo formal

```{r}
sjt.xtab(casen_rec$trabajo, casen_rec$sexo,
         show.col.prc=TRUE,
         show.summary=FALSE,
         encoding = "UTF-8"
)
```

Esta primera tabla nos ofrece lo siguiente, la cantidad de personas que realizan trabajo formal, son mas hombres que mujeres con una diferencia de 22.8% a favor de los hombres. mientras las mujeres son quienes mas no han realizado trabajo formal respecto a los hombres tambien es una difencia de 22.8% en favor a este caso a las mujeres.

b\) Realizo algun trabajo de manera informal

```{r}
sjt.xtab(casen_rec$trabajo_informal, casen_rec$sexo,
         show.col.prc=TRUE,
         show.summary=FALSE,
         encoding = "UTF-8"
)
```

En este caso la participacion en trabajos informales, tanto hombres como mujeres son pocos quienes realmente realizan un trabajo informal, sin embargo las mujeres fueron quienes realizaron mas trabjo informal respecto a los hombres.

c\) Cuantas horas trabajo a la semana

```{r}
sjt.xtab(casen_rec$horas_trabajo, casen_rec$sexo,
         show.col.prc=TRUE,
         show.summary=FALSE,
         encoding = "UTF-8"
)
```

Ahora bien cuando analizamos las horas de trabajo entre hombres y mujeres obsrvamos lo siguiente si nos fijamos en las horas promedios, que es trabar 40 horas semanales, vemos que son las mujeres quienes mas se encuentran.

Tanto hombres como mujeres traban mas horas que el promedio, sin embargo son lo hombres quienes mas realizan horas de trabajo sobre el promedio. y por su contra parte quienes realizan menos horas de trabjo son las mujeres.

d\) Razonas por la cual no busco trabajo

```{r}
sjt.xtab(casen_rec$busqueda_trabajo, casen_rec$sexo,
         show.col.prc=TRUE,
         show.summary=FALSE,
         encoding = "UTF-8"
)
```

Esta tabla es bien interezante, ya que responde a porque la personas que no trabajan, no hay buscado acceder a un trabajo, dentro de las opciones agrupe todas las que referian al cuidado de algun familiar, niño, etc y cuidado domestico, toda cualquier otra razon la agrupe en otro motivo. El resultado de esto se ve en la tabla, de la cual podemos debelar que, si nos fijamos en la opcion de razones de cuidado, vemos una amplia diferecia entre hombres y mujeres, donde solo un 6.4% de hombres no buscaron trabajo por razones de cuidado, mientras que las mujetes fueron un 51.6%, observamos una amlia diferencia en este punto, podriamos hablar de como influye la brecha de genero (CITAAA).

e\) Sueldo

```{r}
sjt.xtab(casen_rec$sueldo, casen_rec$sexo,
         show.col.prc=TRUE,
         show.summary=FALSE,
         encoding = "UTF-8"
)
```

En esta ultima tabla obtememos lo siguien blablablablablabla

blablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablalablablablablablalablablablablablblablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablabla blablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablablabla blablablablablabla

### Correlacion entre variables

Para efectos de la investigacion en este momento es necesario reconfigurar un par de variables que anteriormente estabamos analizando como categoricas, ahora en numericas. Esto es realizado con el objetivo de poder realizar la correlacion en de estas variables, para posteriormente realizar la escala.

```{r}
frq(casen_rec$trabajo) # Recodificacion numerica
casen_rec$trabajo <- recode(casen_rec$trabajo, "No trabaja" = 0, "Trabaja" = 1)
summary(casen_rec$trabajo) #Confirmacion

frq(casen_rec$trabajo_informal) # Recodificacion numerica
casen_rec$trabajo_informal <- recode(casen_rec$trabajo_informal, "No trabaja" = 0, "Trabaja" = 1)
summary(casen_rec$trabajo_informal) #Confirmacion

frq(casen_rec$horas_trabajo) # Recodificacion numerica
casen_rec$horas_trabajo <- recode(casen_rec$horas_trabajo, "Inf promedio" = 0, "Promedio" = 0.5, "Sup promedio" = 1)
summary(casen_rec$horas_trabajo) #Confirmacion

frq(casen_rec$sueldo) # Recodificacion numerica
casen_rec$sueldo<- recode(casen_rec$sueldo, "Menos del salario minimo" = 0, "Salario promedio" = 0.5, "Salario sobre el promedio" = 1)
summary(casen_rec$sueldo) #Confirmacion
```

En este punto de la investigación es necesario trabajar con una recodificación de la base datos anterior, ya que como se encuentra codificada actualmente era útil para un primer análisis de los datos, sin embargo, para la construcción del índice es necesario recodificarla.

Para la correlacion realice un objeto con solo las variables necesarias para esta correlacion

```{r}
casen_correlacion <- casen_rec %>% select(trabajo_informal, # Trabajo informal
                                          horas_trabajo, # Horas trabajadas
                                          tipo_trabajo, # Su trabajo es de tipo
                                          contrato, # Tipo de contrato
                                          jornada_labora, #Jornada laboral
                                          horario_trabajo, #Tipo de horario
                                          sueldo) # Sueldo
```

#### Casos perdidos (NA´s)

Es importante trabajar los casos perdidos (NA´s), para que no alteren la correlacion entre las variables, para esto he decidido realizar la filtracion de los casos perdidos por "Listwise delectio" ya que blablabla y ademas.El procedimiento es el siguiente:

-   Primero respaldar la base de datos, en este caso el objeto para la correlacion

```{r}
df <- casen_correlacion
dim(casen_correlacion)
```

-   Despues contamos los NA´s

```{r}
sum(is.na(casen_correlacion))
```

-   Vemos en que variables se encuentran estos NA´s

```{r}
colSums(is.na(casen_correlacion))
```

-   Y finalmente las eliminamos

```{r}
casen_correlacion <- na.omit(casen_correlacion)
dim(casen_correlacion)
```

### Contruccion de matriz de correlacion

```{r}
M <- cor(casen_correlacion, use = "complete.obs") # Matriz de correlacion
M
```

```{r}
sjPlot::tab_corr(M, # Visualizacion
                 triangle = "lower")
```

```{r}
corrplot.mixed(M)
```

### Alfa de Cronbach

```{r}
# Asegúrate de tener el paquete psych instalado y cargado
if (!requireNamespace("psych", quietly = TRUE)) {
  install.packages("psych")
}
library(psych)

# Calcular el alpha de Cronbach con la opción check.keys=TRUE
alpha_result <- psych::alpha(casen_correlacion, check.keys=TRUE)

# Ver los resultados
print(alpha_result)

# Ver cuáles variables fueron invertidas
print(alpha_result$keys)
```

Desarrollar esto en profuncidad, recordar que tuve que invertir las variables pero debo justificar por que

### Contruccion de la escala

```{r}
casen_rec <- casen_rec %>% 
  rowwise() %>% 
  mutate(participacion_mercado_laboral = sum(trabajo,trabajo_informal,horas_trabajo,tipo_trabajo,contrato,jornada_labora,horario_trabajo,sueldo))
summary(casen_rec$participacion_mercado_laboral)
```

ddddddddddddddddddd

```{r}
frq(casen_rec$participacion_mercado_laboral)
```

ddddddddddddddddddd

Grafico

```{r}
ggplot(casen_rec, aes(x = participacion_mercado_laboral)) +
  geom_histogram(binwidth=0.6, colour="black", fill="yellow") +
  theme_bw() +
  xlab("Participacion en el mercado laboral") +
  ylab("Cantidad")
```

blablablablabl

Antes de continuar es necesario guardar la base datos, para trabajar con las variables para la regresion con escala

### Guardar la nueva vase de datos (casen_reg)

```{r}
casen_reg <- casen_rec %>% select(participacion_mercado_laboral,
                                  sexo,
                                  educ,
                                  nacionalidad,
                                  pueblo_originario)

save(casen_reg,file = "1. input/casen_reg.rdata")
```

## Regresion 

Como ahora trabajare con otra base de datos es necesario limpiar el area de trabajo, cargar los paquetes necesarios, y asi continuar

```{r}
rm(list = ls()) #limpiar area de trabajo

pacman::p_load(dplyr,
               car, 
               sjmisc, 
               sjPlot, 
               sjlabelled, 
               stargazer, 
               kableExtra, 
               corrplot, 
               texreg, 
               ggplot2, 
               ggpubr,
               summarytools, # Tablas
               sessioninfo, # Información de la sesión de trabajo
               fastDummies, # Generar regresión
               ggeffects) # Gráfico de valores predichos
```

Cargamos esta nueva base da datos recodificada con lo necesario para realizar la regresion

```{r}
load(url("https://github.com/panchamama/Practico-1/raw/main/1.%20input/casen_reg.rdata"))
dim(casen_reg)
```

```{r}
casen_reg <- casen_reg %>% select(participacion_mercado_laboral, sexo, educ, nacionalidad, pueblo_originario)
```

ffffffffffff

```{r}
casen_reg <- data.frame(lapply(casen_reg, function(x) {
  if (is.factor(x)) as.numeric(as.factor(x)) else x
}))
```

```{r}
# Seleccionar solo las columnas numéricas
casen_reg_numeric <- casen_reg[sapply(casen_reg, is.numeric)]
```

```{r}
# Calcular la matriz de correlación utilizando solo las observaciones completas
M <- cor(casen_reg_numeric, use = "complete.obs")
print(M)


M <- cor(casen_reg, use = "complete.obs") # Usar solo casos con observaciones completas
diag(M) = NA # Elimina la diagonal (correlaciones absolutas de cada variable consigmo misma)
rownames(M) <- c("A. Participacion en el mescado laboral",
                 "B. Sexo",
                 "C. Educación",
                 "D. Nacionalidad",
                 "E. Pertenece a pueblo originario")
colnames(M) <-c("(A)", "(B)","(C)", "(D)", "(E)")

corrplot::corrplot(M,
                   method = "color", # Cambia los círculos por color completo de cada cuadrante
                   addCoef.col = "#000390", # Color de los coeficientes
                   type = "upper", # Deja solo las correlaciones de arriba
                   tl.col = "black", # COlor letras, rojo por defecto
                   na.label = "-")

```

nos aseguramos ahora que todas las variables sean categoricas

```{r}
casen_reg$educ <- as_factor(casen_reg$educ)
casen_reg$sexo <- as_factor(casen_reg$sexo)
casen_reg$nacionalidad <- as_factor(casen_reg$nacionalidad)
casen_reg$pueblo_originario <- as_factor(casen_reg$pueblo_originario)
```

y ahora realiizamos la regresion

### Regrasion 1

```{r}
casen_reg <- na.omit(casen_reg)
reg1 <- lm(participacion_mercado_laboral ~ 1, data=casen_reg)
stargazer(reg1, type="text")
```

### Regresione lineal multiple

El objetivo de esto es realizar un analisis entre los distinros modelos, para evaluar la participacion en el mercado laboral, y asi ver ver que variables afectan esta participacion.

```{r}
reg2<- lm(participacion_mercado_laboral ~ sexo, data = casen_reg)
reg3 <- lm(participacion_mercado_laboral ~ sexo + educ, data = casen_reg)
reg4 <- lm(participacion_mercado_laboral ~ sexo + educ + nacionalidad, data = casen_reg)
reg5 <- lm(participacion_mercado_laboral ~ sexo + educ + nacionalidad + pueblo_originario, data = casen_reg)
```

```{r}
knitreg(list(reg2, reg3, reg4, reg5), 
        custom.model.names = c("Modelo 1",
                               "Modelo 2",
                               "Modelo 3",
                               "Modelo 4"),
        custom.note = "*** p < 0.001; ** p < 0.01; * p < 0.05",
        custom.coef.names = c("Intercepto", 
                              "Mujer <br> <i>(Ref. Hombre)</i>",
                              "Sin estudios <br> <i>(Ref. Ed. básica)</i>",
                              "Educación media", 
                              "Educación superior",
                              "Postgrados",
                              "Nacionalidad extranjera <br> <i>(Ref. Nacionalidad chilena)</i>",
                              "Pertenece puablo originario <br> <i>(Ref. No pertenece pueblo originario)</i>"),
        caption = "Participacion en el mercado laboral",
        caption.above = TRUE)
```

sssssssssssssssssssss

```{r}

```
